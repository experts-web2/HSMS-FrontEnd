<div class="flex" *ngIf="!tokenId">
  <div class="mb-5 mt-3 flex flex-col md:flex-row justify-content-between justify-items-center position-relative">
    <label for="patient">Patient</label>
    <p-autoComplete #autoComplete [suggestions]="( !autoComplete || autoComplete.inputValue === '' ? patients: patientsToShow)" (completeMethod)="searchPatient(autoComplete)" (onSelect)="patientSelect(autoComplete.value.id)" field="name"></p-autoComplete>
    
  </div>
  <select class="w-1/5 rounded border-solid border-2 h-10 mb-5 mt-3 flex flex-col md:flex-row justify-content-between justify-items-center position-relative" name="" id="" #patientHistory
    (change)="selectPatientHistoryVisit(patientHistory.value)" [disabled]="!patientHistoryVisits">
    <option [value]="null" [defaultSelected]="true" disabled>Select a history visit</option>
    <option *ngFor="let visit of patientHistoryVisits" [value]="visit.id">{{visit.createdAt | date: 'EEE MMM, dd/yyyy'}}</option>
  </select>
  <div>

  </div>
</div>
<div class="patient-page">
  <div>
    <h1 class="first-title">Current Appointment</h1>
  </div>
  <div class="grid grid-cols-1 xl:grid-cols-3 xl:gap-x-4 gap-y-4 justify-between" *ngIf="patient && token">
    <section class="grid grid-cols-1 md:grid-cols-3 xl:grid-cols-1 xl:order-2 gap-x-3 gap-y-3 justify-between">
      <div class="d-flex flex-column bg-white align-items-center p-3 rounded-3">
        <img src="https://static.vecteezy.com/system/resources/previews/005/544/718/original/profile-icon-design-free-vector.jpg" alt="Profile Picture"
          class="profile-picture rounded-5 bg-dark">
        <div class="profile-details">
          <h1 class="profile-name my-2">{{patient.name}}</h1>
          <p class="profile-info"><b>{{getGender(patient.gender)}}:</b> {{patient.age.split('-').at(0)}}</p>
          <p class="profile-location my-2">{{''}}</p>
        </div>
        <button class="btn btn-success">Update</button>
      </div>
      <div class="col-span-2">
        <p-panel header="Summary" [toggleable]="true" aria-expanded="false">
          <div class="medical-info d-flex flex-column bg-white align-items-center">
            <h2 class="section-title">Vitals</h2>
            <div class="history-item-div"><span class="patient-info-labels"><i
                  class="fa-solid w-5 fa-heart-pulse mr-3"></i>Pulse Heart
                Rate:</span><span>{{token.tokenDetail?.pulseHeartRate ?? 'N/A'}}</span></div>
            <div class="history-item-div"><span class="patient-info-labels"><i
                  class="fa fas w-5 fa-regular fa-temperature-high mr-3"></i>Temprature:</span><span>{{token.tokenDetail?.temperature
                ?? 'N/A'}}</span></div>
            <div class="history-item-div"><span class="patient-info-labels"><i
                  class="fa-solid w-5 fa-light fa-ruler-vertical mr-3"></i>height:</span><span>{{token.tokenDetail?.height
                ?? 'N/A'}}</span></div>
            <div class="history-item-div"><span class="patient-info-labels"><i
                  class="fa-solid w-5 fa-weight-scale mr-3"></i>Weight (in kg e.g:
                70):</span><span>{{token.tokenDetail?.weight ?? 'N/A'}}</span></div>
            <div class="history-item-div"><span class="patient-info-labels"><i
                  class="fa-solid w-5 fa-child mr-3"></i>Body Mass Index
                (BMI):</span><span>{{token.tokenDetail?.bodyMassIndex ?? 'N/A'}}</span></div>
            <div class="history-item-div"><span class="patient-info-labels"><i
                  class="fa-solid w-5 fa-heart mr-3"></i>Blood Pressure:</span><span>{{token.tokenDetail?.bloodPressure
                ?? 'N/A'}}</span></div>
            <div class="history-item-div"><span class="patient-info-labels"><i
                  class="fa-solid w-5 fa-lungs mr-3"></i>Oxygen
                Saturation:</span><span>{{token.tokenDetail?.oxygenSaturation ?? 'N/A'}}</span></div>
            <div class="history-item-div"><span class="patient-info-labels"><i
                  class="fa-solid w-5 fa-lungs mr-3"></i>Respiratory
                Rate:</span><span>{{token.tokenDetail?.respiratoryRate ?? 'N/A'}}</span></div>
            <div class="history-item-div"><span class="patient-info-labels"><i
                  class="fa-solid w-5 fa-lungs mr-3"></i>Blood Sugar:</span><span>{{token.tokenDetail?.bloodSugar ??
                'N/A'}}</span></div>
            <!-- <div class="history-item-div"><span class="patient-info-labels">Last
              Visit:</span><span>{{'11/2/2023'|date}}</span></div> -->
            <!-- More history items here -->
          </div>
        </p-panel>
      </div>
    </section>
    <section class="d-flex flex-column col-span-2 xl:order-1">
      <!-- <div class="medical-info d-flex justify-content-between align-items-center m-3">
        <div class="medical-history-card">
          <div>
            <img class="medical-history-images" src="../../../../assets/images/heartRate.png">
          </div>
          <span class="m-history-card-heading">Heart Rate</span>
          <span class="m-history-card-heading readingUnit"><span class="m-history-card-reading">80</span>bpm</span>
        </div>
        <div class="medical-history-card">
          <div>
            <img class="medical-history-images" src="../../../../assets/images/thermometer.png">
          </div>
          <span class="m-history-card-heading">Body Temprature</span>
          <span class="m-history-card-heading readingUnit"><span class="m-history-card-reading">30</span>Â°C</span>
        </div>
        <div class="medical-history-card">
          <div>
            <img class="medical-history-images" src="../../../../assets/images/sugar-blood-level.png">
          </div>
          <span class="m-history-card-heading">Glucose</span>
          <span class="m-history-card-heading readingUnit"><span class="m-history-card-reading">100</span>mg/dl</span>
        </div>
      </div> -->
      <!-- <div class=" flex-column bg-white align-items-center p-2 rounded-3 m-3">
        <h2 class="section-title">Test Reports</h2>
        <div class="row px-2">
          <mat-card class="s shadow-none  col-md-6">
            <mat-card-header>
              <mat-card-title class="d-flex align-items-start"><div class="clipboard-icon"><i class="fas fa-clipboard"></i></div>
                <div class="px-2">
                  <div>
                    Actions Buttons
                  </div>
                  <div>
                    Start
                  </div>
                </div>
              </mat-card-title>
            </mat-card-header>
            <mat-card-actions align="end">
              <button mat-button>LIKE</button>
              <button mat-button>SHARE</button>
            </mat-card-actions>
          </mat-card>
          <mat-card class=" mt-3 shadow-none  mt-md-0 col-md-6 ">
            <mat-card-header>
              <span>
                <i class="fi fi-user"></i>
              </span>
              <mat-card-title class="d-flex align-items-start"><div class="clipboard-icon"><i class="fas fa-clipboard"></i></div>
                <div class="px-2">
                  <div>Actions Buttons</div>
                  <div>End</div>
                </div>
              </mat-card-title>
            </mat-card-header>
            <mat-card-actions align="end">
              <button mat-button>LIKE</button>
              <button mat-button>SHARE</button>
            </mat-card-actions>
          </mat-card>
        </div>
      </div> -->
      <div class=" flex-column bg-white align-items-center p-3 rounded-3">
        <div>
          <p-tabView>
            <p-tabPanel header="Prescription">
              <app-prescription [token]="token" [historyTokenId]="historyTokenId"></app-prescription>
            </p-tabPanel>
            <p-tabPanel header="Vitals">
              <app-vitals [token]="token" [historyTokenId]="historyTokenId"></app-vitals>
            </p-tabPanel>
            <p-tabPanel header="Medication">
              <app-medication [token]="token" [historyTokenId]="historyTokenId"></app-medication>
            </p-tabPanel>
            <p-tabPanel header="Lab Order">
              <app-lab-order [token]="token"></app-lab-order>
            </p-tabPanel>
            <p-tabPanel header="Radiology Order">
              <p>
                At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum
                deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non
                provident, similique sunt in culpa
                qui officia deserunt mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est
                et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo
                minus.
              </p>
            </p-tabPanel>
          </p-tabView>
        </div>

        <!-- <h2 class="section-title">Prescriptions</h2>
        <button class="btn btn-secondry btn-success" (click)="showDialogueMethod()">+ Add Prescription</button>
        <div class="d-flex align-items-center">
          <hr class="col-6">
        </div>
        <table mat-table [dataSource]="[{prescriptions:'Peracitaml', date:'14/16/2023', duration: '2 Months'}]"
          class="">
          <ng-container matColumnDef="prescriptions">
            <th mat-header-cell *matHeaderCellDef> Prescriptions </th>
            <td mat-cell *matCellDef="let element"> {{element.prescriptions}} </td>
          </ng-container>

          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef> Date </th>
            <td mat-cell *matCellDef="let element"> {{element.date}} </td>
          </ng-container>

          <ng-container matColumnDef="duration">
            <th mat-header-cell *matHeaderCellDef> Duration </th>
            <td mat-cell *matCellDef="let element"> {{element.duration}} </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="['prescriptions', 'date', 'duration']"></tr>
          <tr mat-row *matRowDef="let row; columns: ['prescriptions', 'date', 'duration'];"></tr>
        </table> -->
      </div>
    </section>
  </div>
  <!-- <app-add-prescription-dialogue (show)="showDialogueMethod=$event"></app-add-prescription-dialogue> -->
  <!-- <button (click)="showDialogueMethod()">open dialogue</button> -->
</div>